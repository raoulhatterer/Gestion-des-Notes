<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
<!-- 2020-08-16 Sun 00:55 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gestion des notes</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Raoul HATTERER" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Gestion des notes
<br />
<span class="subtitle">(Projet DIU)</span>
</h1>
<div id="table-of-contents">
<h2>Table des matières</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3f30891">1. Installation et démarrage du serveur MariaDB</a>
<ul>
<li><a href="#org054ede4">1.1. Installer Homebrew</a></li>
<li><a href="#org29c4207">1.2. Installer MariaDB</a></li>
<li><a href="#orgc8f9aa1">1.3. Démarrer MariaDB Server</a></li>
<li><a href="#org4da9fa7">1.4. Vérifier que MariaDB a démarré</a></li>
</ul>
</li>
<li><a href="#org103d412">2. Connexion au serveur à travers le client <code>mysql</code></a>
<ul>
<li><a href="#orgf532102">2.1. Client-serveur</a></li>
<li><a href="#org768a0a7">2.2. À la création, la base de donnée est initialisée avec 2 comptes</a></li>
<li><a href="#org1aab796">2.3. Activer l'accès au compte <code>root</code></a></li>
</ul>
</li>
<li><a href="#orgd8b3739">3. Création par <code>root</code> d'une nouvelle base de données et d'un gestionnaire pour assurer sa gestion</a>
<ul>
<li><a href="#org771c24a">3.1. Login en tant que <code>root</code></a></li>
<li><a href="#org2b97e34">3.2. Création de la nouvelle base de données <code>bd_gestion_des_notes</code>:</a></li>
<li><a href="#orgd17b341">3.3. Types d'utilisateurs d'un SGBP</a></li>
<li><a href="#org0f94d25">3.4. Création d'un utilisateur <code>gestionnaire</code></a></li>
<li><a href="#org1bcf827">3.5. Mot de passe et sécurité</a></li>
</ul>
</li>
<li><a href="#org0f7721e">4. Afficher les utilisateurs</a>
<ul>
<li><a href="#org11fc765">4.1. Afficher tous les utilisateurs (en tant qu'administrateur)</a></li>
<li><a href="#orga9b647b">4.2. Afficher l'utilisateur connecté</a></li>
</ul>
</li>
<li><a href="#org2bfa300">5. Gestion de la base de données</a>
<ul>
<li><a href="#org4375d74">5.1. Lister les bases de données (auxquelles le gestionnaire a accès)</a></li>
<li><a href="#org507eb33">5.2. Se connecter à une base de données</a></li>
<li><a href="#org31cad56">5.3. Afficher les tables de la base courante</a></li>
<li><a href="#orge6b076c">5.4. Afficher la structure de la table</a></li>
<li><a href="#org9252bba">5.5. Créer une nouvelle table</a></li>
<li><a href="#orge58b747">5.6. Ajouter une colonne à une table</a></li>
<li><a href="#orgd65df8b">5.7. Effacer une colonne</a></li>
<li><a href="#org8dd914f">5.8. Effacer une table</a></li>
<li><a href="#orgca43b52">5.9. Afficher le contenu de la table</a></li>
</ul>
</li>
<li><a href="#org6dde6a9">6. SQL avec emacs</a>
<ul>
<li><a href="#org47d87c6">6.1. Se connecter au client <code>mysql</code> dans emacs</a></li>
<li><a href="#orgf157062">6.2. Si emacs ne trouve pas le programme mysql</a></li>
<li><a href="#org263aaaf">6.3. Faciliter la connexion</a></li>
<li><a href="#org94ab37e">6.4. Mots clés automatiquement en majuscule</a></li>
<li><a href="#org7396b8e">6.5. Autocompletion</a></li>
</ul>
</li>
<li><a href="#org627795a">7. Exécuter un script sql</a></li>
<li><a href="#org9fb1fbd">8. Python tkinter table widget for displaying tabular data</a>
<ul>
<li><a href="#org57c5ddc">8.1. installation</a></li>
<li><a href="#org9567756">8.2. source</a></li>
<li><a href="#orgcc3cc31">8.3. paramètres</a></li>
<li><a href="#org8a86304">8.4. fonctions</a></li>
</ul>
</li>
<li><a href="#orgfeea966">9. Fonctionnalités  et Modèle Conceptuel des Données (MCD)</a>
<ul>
<li><a href="#org488d518">9.1. Ajout de discipline ;</a></li>
<li><a href="#orgfee3c9a">9.2. Ajout d'enseignants ;</a></li>
<li><a href="#orgef4aa22">9.3. Ajout d'élèves ;</a></li>
<li><a href="#orga56add4">9.4. Créer les classes chaque année pour chaque niveau ;</a></li>
<li><a href="#org0f8d6aa">9.5. Affecter les notes d'une discipline donnée par un professeur à un élève ;</a></li>
<li><a href="#org7bc29f0">9.6. Calculer les moyennes et autres statistiques liées aux notes.</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-org3f30891" class="outline-2">
<h2 id="org3f30891"><span class="section-number-2">1</span> Installation et démarrage du serveur MariaDB</h2>
<div class="outline-text-2" id="text-1">
<p>
<b>Remarque</b>: Certaines parties concernent plus spécifiquement mon utilisation personnelle avec <a href="https://emacsformacosx.com">emacs sous OSX</a>.
</p>
</div>

<div id="outline-container-org054ede4" class="outline-3">
<h3 id="org054ede4"><span class="section-number-3">1.1</span> Installer Homebrew</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Pour installer MariaDB, il faut disposer de <a href="https://brew.sh/index_fr">Homebrew</a> (The Missing Package Manager for macOS).
</p>
</div>
</div>

<div id="outline-container-org29c4207" class="outline-3">
<h3 id="org29c4207"><span class="section-number-3">1.2</span> Installer MariaDB</h3>
<div class="outline-text-3" id="text-1-2">
<p>
MariaDB Server peut ensuite être installé grâce à cette commande (à taper dans le <code>Terminal</code>):
</p>

<div class="org-src-container">
<pre class="src src-shell" id="org6eee1eb">brew update
brew install mariadb
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc8f9aa1" class="outline-3">
<h3 id="orgc8f9aa1"><span class="section-number-3">1.3</span> Démarrer MariaDB Server</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Après installation, on peut (mais on ne va pas le faire) démarrer le serveur avec la commande:
</p>
<div class="org-src-container">
<pre class="src src-shell" id="orge934494">mysql.server start
</pre>
</div>

<p>
Il est plus commode d'activer le démarrage automatique du serveur:
</p>

<div class="org-src-container">
<pre class="src src-shell" id="orgf02f697">brew services start mariadb
</pre>
</div>
</div>
</div>

<div id="outline-container-org4da9fa7" class="outline-3">
<h3 id="org4da9fa7"><span class="section-number-3">1.4</span> Vérifier que MariaDB a démarré</h3>
<div class="outline-text-3" id="text-1-4">
<div class="org-src-container">
<pre class="src src-shell" id="orge2094ad">brew services list
</pre>
</div>

<p>
Cette commande doit retourner <code>mariadb started</code>.
</p>
</div>
</div>
</div>


<div id="outline-container-org103d412" class="outline-2">
<h2 id="org103d412"><span class="section-number-2">2</span> Connexion au serveur à travers le client <code>mysql</code></h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgf532102" class="outline-3">
<h3 id="orgf532102"><span class="section-number-3">2.1</span> Client-serveur</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Comme la plupart des SGBD ([S]ystème de [G]estion de [B]ase de [D]onnées), MariaDB est basée sur le <b>modèle client-serveur</b>. Cela implique que la base de données se trouve sur un <b>serveur</b> auquel nous n'avons pas accès directement. Il faut passer par un <b>client</b> qui fera la liaison entre nous et le serveur.
</p>

<p>
Donc, maintenant que  MariaDB Server a démarré, on va s'y connecter en utilisant un logiciel client (nommé <code>mysql</code>)&#x2026; mais sous quelle identité et avec quels droits?
</p>
</div>
</div>

<div id="outline-container-org768a0a7" class="outline-3">
<h3 id="org768a0a7"><span class="section-number-3">2.2</span> À la création, la base de donnée est initialisée avec 2 comptes</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Le premier compte correspond au nom d'utilisateur actuel (checké avec la commande <code>whoami</code>); il ne nécessite pas de mot de passe;</li>
<li>Le second est le compte administrateur <code>root</code> ; il est inaccessible tant qu'on n'a pas défini de mot de passe.</li>
</ul>

<p>
On va donc faire ce qu'il faut pour activer l'accès au compte administrateur (root) puis s'y connecter pour créer une base de données (<code>bd_gestion_des_notes</code>).
</p>
</div>
</div>


<div id="outline-container-org1aab796" class="outline-3">
<h3 id="org1aab796"><span class="section-number-3">2.3</span> Activer l'accès au compte <code>root</code></h3>
<div class="outline-text-3" id="text-2-3">
<p>
Pour cela, d'abord se connecter au client <b>mysql</b>  avec son nom d'utilisateur:
</p>

<div class="org-src-container">
<pre class="src src-shell" id="org7c9c2a0">mysql -u $(whoami)
</pre>
</div>

<p>
Puis, grâce au commandes du client <b>mysql</b>, définir le mot de passe de <code>root</code>:
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org9f0f71b">SHOW databases;
USE mysql;
<span style="color: #a020f0;">SET</span> password <span style="color: #a020f0;">FOR</span> <span style="color: #8b2252;">'root'</span>@<span style="color: #8b2252;">'localhost'</span> = 
password(<span style="color: #8b2252;">'YOUR_ROOT_PASSWORD_HERE'</span>);
FLUSH <span style="color: #a020f0;">PRIVILEGES</span>;
quit
</pre>
</div>

<p>
où <code>YOUR_ROOT_PASSWORD_HERE</code> est à remplacer par le mot de passe souhaité.
</p>
</div>
</div>
</div>



<div id="outline-container-orgd8b3739" class="outline-2">
<h2 id="orgd8b3739"><span class="section-number-2">3</span> Création par <code>root</code> d'une nouvelle base de données et d'un gestionnaire pour assurer sa gestion</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org771c24a" class="outline-3">
<h3 id="org771c24a"><span class="section-number-3">3.1</span> Login en tant que <code>root</code></h3>
<div class="outline-text-3" id="text-3-1">
<p>
Maintenant, nous pouvons nous connecter en tant que <code>root</code>:
</p>

<div class="org-src-container">
<pre class="src src-shell" id="orga0e3c8d">mysql -u root -p
</pre>
</div>

<p>
Il faudra fournir le mot de passe renseigné à l'étape précédente.
</p>
</div>
</div>

<div id="outline-container-org2b97e34" class="outline-3">
<h3 id="org2b97e34"><span class="section-number-3">3.2</span> Création de la nouvelle base de données <code>bd_gestion_des_notes</code>:</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-sql" id="org1d8b7f0"><span style="color: #a020f0;">CREATE</span> DATABASE bd_gestion_des_notes;
SHOW DATABASES;
</pre>
</div>

<p>
où:
</p>
<div class="org-src-container">
<pre class="src src-sql" id="org298453b"><span style="color: #a020f0;">CREATE</span> DATABASE nom_database;
</pre>
</div>

<p>
permet de créer une nouvelle base de données et:
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org396a01c">SHOW DATABASES;
</pre>
</div>
<p>
permet d'afficher la liste des bases de données.
</p>

<p>
Si l'on souhaite effacer une base de donnée:<br />
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org0c1c65a"><span style="color: #a020f0;">DROP</span> DATABASE nom_database;
</pre>
</div>
</div>
</div>



<div id="outline-container-orgd17b341" class="outline-3">
<h3 id="orgd17b341"><span class="section-number-3">3.3</span> Types d'utilisateurs d'un SGBP</h3>
<div class="outline-text-3" id="text-3-3">
<p>
De façon générale, trois types d'<b>utilisateurs</b> ayant chacun des <b>rôles</b> bien distincts sont à distinguer :
</p>
<ol class="org-ol">
<li><b>L'administrateur</b> du SGBD et donc des Bases de Données. Il s'appelle <code>root</code>. Son rôle est d'installer et gérer le SGBD dans sa globalité. Chaque fois que l'administrateur crée une base de données, il délègue sa gestion à un autre utilisateur à qui il donne les droits nécessaires. <b>Remarque:</b>  Il ne faut pas travailler sur une bases de données en tant que <code>root</code>; ce n'est pas son rôle (<a href="https://www.youtube.com/watch?v=oiQG6tP3940">c'est mal</a>).</li>
<li><b>Le gestionnaire</b> de Bases de Données (dans un SGBD existant) qui doit connaître  <b>sql</b> (Structured Query Language) : création (CREATE TABLE), modification (ALTER TABLE), suppression (DROP TABLE) de tables&#x2026;</li>
<li><b>L'utilisateur final</b> de la base de donnée. Il va interagir avec tout ou partie de la base de donnée à travers une application se voulant conviviale; il n'a pas à connaître <b>sql</b>.</li>
</ol>


<p>
Le SGBD permet de créer différents utilisateurs avec des droits spécifiques, mais il permet aussi de créer différents rôles correspondant à des droits spécifiques ce qui rend la gestion d'utilisateurs ayant des droits identiques plus efficace.
</p>
</div>
</div>

<div id="outline-container-org0f94d25" class="outline-3">
<h3 id="org0f94d25"><span class="section-number-3">3.4</span> Création d'un utilisateur <code>gestionnaire</code></h3>
<div class="outline-text-3" id="text-3-4">
<p>
Utilisateur à qui <code>root</code> va donner les droits nécessaires pour créer ou modifier des tables dans la base de données <code>bd_gestion_des_notes</code> ou pour inscrire des utilisateurs.
</p>
</div>


<div id="outline-container-org6752175" class="outline-4">
<h4 id="org6752175"><span class="section-number-4">3.4.1</span> Méthode 1</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
On pourrait procéder ainsi: 
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org6ef8e0f"><span style="color: #a020f0;">CREATE</span> <span style="color: #483d8b;">USER</span> user_gestionnaire@localhost
IDENTIFIED <span style="color: #a020f0;">BY</span> <span style="color: #8b2252;">'gestionnaire'</span>;
<span style="color: #a020f0;">GRANT</span> <span style="color: #a020f0;">ALL</span> <span style="color: #a020f0;">PRIVILEGES</span> <span style="color: #a020f0;">ON</span> bd_gestion_des_notes.* 
<span style="color: #a020f0;">TO</span> user_gestionnaire@localhost;
quit
</pre>
</div>


<p>
Se connecter au client <code>mysql</code> en tant que gestionnaire
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org50d884c">mysql -u user_gestionnaire -p
</pre>
</div>

<p>
Saisir le mot de passe précédemment défini. 
</p>


<p>
Mais nous allons plutôt employer la seconde méthode (voir <a href="#org0b587a2">3.4.2</a> ).
</p>

<p>
Mais, en tant que <code>root</code>, commençons par effacer (si besoin) l'utilisateur <code>gestionnaire</code> :<br />
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org219e22b"><span style="color: #a020f0;">DROP</span> <span style="color: #483d8b;">USER</span> user_gestionnaire@localhost;
</pre>
</div>
</div>
</div>


<div id="outline-container-org0b587a2" class="outline-4">
<h4 id="org0b587a2"><span class="section-number-4">3.4.2</span> Méthode 2</h4>
<div class="outline-text-4" id="text-3-4-2">
<ul class="org-ul">
<li>Création du rôle de gestionnaire</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql" id="org2afe9fc"><span style="color: #a020f0;">CREATE</span> <span style="color: #a020f0;">OR</span> replace <span style="color: #a020f0;">ROLE</span> role_gestionnaire;
<span style="color: #a020f0;">GRANT</span> <span style="color: #a020f0;">ALL</span> 
<span style="color: #a020f0;">ON</span> bd_gestion_des_notes.* 
<span style="color: #a020f0;">TO</span> role_gestionnaire;
</pre>
</div>

<ul class="org-ul">
<li>Si le "stil" et le "proviseur" sont habilités à endosser ce rôle</li>
</ul>

<div class="org-src-container">
<pre class="src src-sql" id="org13244c2"><span style="color: #a020f0;">CREATE</span> <span style="color: #a020f0;">OR</span> replace <span style="color: #483d8b;">USER</span>  stil@localhost IDENTIFIED <span style="color: #a020f0;">BY</span> <span style="color: #8b2252;">'stilstil'</span>;                 
<span style="color: #a020f0;">GRANT</span> role_gestionnaire
<span style="color: #a020f0;">TO</span> stil@localhost;
<span style="color: #a020f0;">SET</span> <span style="color: #a020f0;">DEFAULT</span> <span style="color: #a020f0;">ROLE</span> role_gestionnaire <span style="color: #a020f0;">FOR</span> stil@localhost;

<span style="color: #a020f0;">CREATE</span> <span style="color: #a020f0;">OR</span> replace <span style="color: #483d8b;">USER</span>  proviseur@localhost IDENTIFIED <span style="color: #a020f0;">BY</span> <span style="color: #8b2252;">'propro'</span>;                 
<span style="color: #a020f0;">GRANT</span> role_gestionnaire
<span style="color: #a020f0;">TO</span> proviseur@localhost;
<span style="color: #a020f0;">SET</span> <span style="color: #a020f0;">DEFAULT</span> <span style="color: #a020f0;">ROLE</span> role_gestionnaire <span style="color: #a020f0;">FOR</span> proviseur@localhost;
</pre>
</div>

<ul class="org-ul">
<li>Pour vérifier le rôle de l'utilisateur connecté:</li>
</ul>
<div class="org-src-container">
<pre class="src src-sql" id="orgf69bebb"><span style="color: #a020f0;">SELECT</span> <span style="color: #483d8b;">CURRENT_ROLE</span>();      
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org1bcf827" class="outline-3">
<h3 id="org1bcf827"><span class="section-number-3">3.5</span> Mot de passe et sécurité</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Les mots de passe précédents seront à utiliser lors de la première connexion. Ensuite, pour des raisons évidentes de sécurité, les utilisateurs doivent se voir proposer un moyen de changer leur mot de passe. 
</p>

<p>
La commande sql est la suivante:
</p>
<div class="org-src-container">
<pre class="src src-sql" id="orgd29fc92"><span style="color: #a020f0;">SET</span> PASSWORD <span style="color: #a020f0;">FOR</span> <span style="color: #8b2252;">'proviseur'</span>@<span style="color: #8b2252;">'localhost'</span> = PASSWORD(<span style="color: #8b2252;">'pro'</span>);
</pre>
</div>

<p>
Mais l'utilisateur final de la BD n'a pas à connaître sql c'est donc à l'application de proposer cette possibilité.
</p>
</div>
</div>
</div>


<div id="outline-container-org0f7721e" class="outline-2">
<h2 id="org0f7721e"><span class="section-number-2">4</span> Afficher les utilisateurs</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org11fc765" class="outline-3">
<h3 id="org11fc765"><span class="section-number-3">4.1</span> Afficher tous les utilisateurs (en tant qu'administrateur)</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Connecté en <code>root</code> saisir la commande:
</p>
<div class="org-src-container">
<pre class="src src-sql" id="org77a2808"><span style="color: #a020f0;">select</span> <span style="color: #a020f0;">host</span>, <span style="color: #483d8b;">user</span> <span style="color: #a020f0;">from</span> mysql.<span style="color: #483d8b;">user</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orga9b647b" class="outline-3">
<h3 id="orga9b647b"><span class="section-number-3">4.2</span> Afficher l'utilisateur connecté</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Deux commandes possibles pour cela:
</p>
<div class="org-src-container">
<pre class="src src-sql" id="org22b1f3d"><span style="color: #a020f0;">SELECT</span> <span style="color: #483d8b;">current_user</span>;
</pre>
</div>

<p>
ou 
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org4dd60b2"><span style="color: #a020f0;">SELECT</span> <span style="color: #483d8b;">user</span>();
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org2bfa300" class="outline-2">
<h2 id="org2bfa300"><span class="section-number-2">5</span> Gestion de la base de données</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org4375d74" class="outline-3">
<h3 id="org4375d74"><span class="section-number-3">5.1</span> Lister les bases de données (auxquelles le gestionnaire a accès)</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre class="src src-sql" id="org50e9759">SHOW DATABASES;
</pre>
</div>
</div>
</div>

<div id="outline-container-org507eb33" class="outline-3">
<h3 id="org507eb33"><span class="section-number-3">5.2</span> Se connecter à une base de données</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Pour utiliser la base de donnée <code>bd_gestion_des_notes</code>:
</p>

<div class="org-src-container">
<pre class="src src-sql" id="orgb524b5e">USE bd_gestion_des_notes;      
</pre>
</div>
</div>
</div>

<div id="outline-container-org31cad56" class="outline-3">
<h3 id="org31cad56"><span class="section-number-3">5.3</span> Afficher les tables de la base courante</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre class="src src-sql" id="orge12eaff">SHOW TABLES;
</pre>
</div>
</div>
</div>

<div id="outline-container-orge6b076c" class="outline-3">
<h3 id="orge6b076c"><span class="section-number-3">5.4</span> Afficher la structure de la table</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">
<pre class="src src-sql" id="org9a429e2">DESCRIBLE nom_table;
</pre>
</div>
</div>
</div>

<div id="outline-container-org9252bba" class="outline-3">
<h3 id="org9252bba"><span class="section-number-3">5.5</span> Créer une nouvelle table</h3>
<div class="outline-text-3" id="text-5-5">
<div class="org-src-container">
<pre class="src src-sql" id="orgbdd1125"><span style="color: #a020f0;">CREATE</span> <span style="color: #a020f0;">TABLE</span> <span style="color: #0000ff;">nom_table</span> (
nom_colonne1 <span style="color: #228b22;">int</span>,
nom_colonne2 <span style="color: #228b22;">VARCHAR</span>(100)
);
</pre>
</div>
</div>
</div>

<div id="outline-container-orge58b747" class="outline-3">
<h3 id="orge58b747"><span class="section-number-3">5.6</span> Ajouter une colonne à une table</h3>
<div class="outline-text-3" id="text-5-6">
<div class="org-src-container">
<pre class="src src-sql" id="org7132d9e"><span style="color: #a020f0;">ALTER</span> <span style="color: #a020f0;">TABLE</span> <span style="color: #0000ff;">nom_table</span> <span style="color: #a020f0;">ADD</span> nom_colonne type_colonne;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd65df8b" class="outline-3">
<h3 id="orgd65df8b"><span class="section-number-3">5.7</span> Effacer une colonne</h3>
<div class="outline-text-3" id="text-5-7">
<div class="org-src-container">
<pre class="src src-sql" id="org65de7d3"><span style="color: #a020f0;">ALTER</span> <span style="color: #a020f0;">TABLE</span> <span style="color: #0000ff;">nom_table</span> <span style="color: #a020f0;">DROP</span> <span style="color: #a020f0;">COLUMN</span> nom_colonne;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8dd914f" class="outline-3">
<h3 id="org8dd914f"><span class="section-number-3">5.8</span> Effacer une table</h3>
<div class="outline-text-3" id="text-5-8">
<div class="org-src-container">
<pre class="src src-sql" id="org3aa686f"><span style="color: #a020f0;">DROP</span> nom_table;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgca43b52" class="outline-3">
<h3 id="orgca43b52"><span class="section-number-3">5.9</span> Afficher le contenu de la table</h3>
<div class="outline-text-3" id="text-5-9">
<div class="org-src-container">
<pre class="src src-sql" id="org662dbbb"><span style="color: #a020f0;">SELECT</span> * <span style="color: #a020f0;">FROM</span> nom_table;
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org6dde6a9" class="outline-2">
<h2 id="org6dde6a9"><span class="section-number-2">6</span> SQL avec emacs</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org47d87c6" class="outline-3">
<h3 id="org47d87c6"><span class="section-number-3">6.1</span> Se connecter au client <code>mysql</code> dans emacs</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Utiliser la commande: <code>M-x sql-mysql</code>
</p>

<p>
Renseigner (avec par exemple):
</p>
<ul class="org-ul">
<li>User: <code>stil</code></li>
<li>Password: <code>stilstil</code></li>
<li>Database : (ne rien mettre)</li>
<li>Server: <code>localhost</code></li>
</ul>
</div>
</div>

<div id="outline-container-orgf157062" class="outline-3">
<h3 id="orgf157062"><span class="section-number-3">6.2</span> Si emacs ne trouve pas le programme mysql</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>Déterminer l'emplacement de <code>mysql</code> avec la commande:</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell" id="org4819c8f"><span style="color: #483d8b;">which</span> mysql
</pre>
</div>
<p>
qui retourne <code>/usr/local/bin/mysql</code>
</p>

<ul class="org-ul">
<li>modifier <code>.emacs.d/init.el</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-elisp" id="org310f371">(add-to-list 'exec-path <span style="color: #8b2252;">"/usr/local/bin"</span>)
</pre>
</div>

<p>
Emacs recherche les programmes dans les répertoires listés dans la variable <code>exec-path</code>. On a ajouté  <code>/usr/local/bin</code> à cette variable.
</p>
</div>
</div>

<div id="outline-container-org263aaaf" class="outline-3">
<h3 id="org263aaaf"><span class="section-number-3">6.3</span> Faciliter la connexion</h3>
<div class="outline-text-3" id="text-6-3">
<p>
À placer dans <code>.emacs.d/init.el</code>
</p>
<div class="org-src-container">
<pre class="src src-elisp" id="orga1ec36e">(<span style="color: #a020f0;">use-package</span> <span style="color: #008b8b;">sql</span>
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (sql-set-product-feature 'mysql <span style="color: #483d8b;">:prompt-regexp</span> 
                 <span style="color: #8b2252;">"^</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">(</span><span style="color: #8b2252;">MariaDB</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">|</span><span style="color: #8b2252;">MySQL</span><span style="color: #8b2252; font-weight: bold;">\\</span><span style="color: #8b2252; font-weight: bold;">)</span><span style="color: #8b2252;"> \\[[_a-zA-Z]*\\]&gt; "</span>)
  (<span style="color: #a020f0;">setq</span> sql-user <span style="color: #8b2252;">"user_gestionnaire"</span>)
  (<span style="color: #a020f0;">setq</span> sql-database <span style="color: #8b2252;">"bd_gestion_des_notes"</span>)
  (<span style="color: #a020f0;">setq</span> sql-server <span style="color: #8b2252;">"localhost"</span>)
  (define-key comint-mode-map [mouse-3] 'comint-insert-input)
  )
</pre>
</div>

<p>
Connexion acilitée, toujours avec la commande <code>M-x sql-mysql</code> et dorénavant il ne reste plus qu'à saisir le mot de passe utilisateur (en l'occurrence: <code>gestionnaire</code>); le reste étant renseigné à l'avance.
</p>
</div>
</div>

<div id="outline-container-org94ab37e" class="outline-3">
<h3 id="org94ab37e"><span class="section-number-3">6.4</span> Mots clés automatiquement en majuscule</h3>
<div class="outline-text-3" id="text-6-4">
<p>
SQLUP-MODE permet d'écrire les mots clés SQL en majuscule.
</p>

<p>
Les lignes suivantes sont  à placer dans le fichier <code>init.el</code>:
</p>

<div class="org-src-container">
<pre class="src src-elisp" id="orgf556fe3">(<span style="color: #a020f0;">use-package</span> <span style="color: #008b8b;">sqlup-mode</span>
  <span style="color: #483d8b;">:ensure</span> t
  <span style="color: #483d8b;">:config</span>
  (add-hook 'sql-mode-hook 'sqlup-mode)
  (add-hook 'sql-interactive-mode-hook 'sqlup-mode)
  (add-hook 'redis-mode-hook 'sqlup-mode)
  )
</pre>
</div>
</div>
</div>

<div id="outline-container-org7396b8e" class="outline-3">
<h3 id="org7396b8e"><span class="section-number-3">6.5</span> Autocompletion</h3>
<div class="outline-text-3" id="text-6-5">
<div class="org-src-container">
<pre class="src src-elisp" id="org3eeedcf"><span style="color: #b22222;">;;; </span><span style="color: #b22222;">SQL COMPLETION</span>
<span style="color: #b22222;">;; </span><span style="color: #b22222;">put the root password in  ~/.emacs.d/lisp/mysql.el</span>
(<span style="color: #a020f0;">require</span> '<span style="color: #008b8b;">sql-completion</span>)
(<span style="color: #a020f0;">setq</span> sql-interactive-mode-hook
      (<span style="color: #a020f0;">lambda</span> ()
        (define-key sql-interactive-mode-map <span style="color: #8b2252;">"\t"</span>
          'comint-dynamic-complete)
        (sql-mysql-completion-init)))

</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org627795a" class="outline-2">
<h2 id="org627795a"><span class="section-number-2">7</span> Exécuter un script sql</h2>
<div class="outline-text-2" id="text-7">
<p>
Il faut déclarer le fichier SQL comme source:
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org9f51dca"><span style="color: #a020f0;">source</span> path_to/the/script_file.<span style="color: #a020f0;">sql</span>
</pre>
</div>

<p>
Par exemple:
</p>

<div class="org-src-container">
<pre class="src src-sql" id="org518f802"><span style="color: #a020f0;">SOURCE</span> ./initdb_gestiondesnotes.<span style="color: #a020f0;">SQL</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org9fb1fbd" class="outline-2">
<h2 id="org9fb1fbd"><span class="section-number-2">8</span> Python tkinter table widget for displaying tabular data</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org57c5ddc" class="outline-3">
<h3 id="org57c5ddc"><span class="section-number-3">8.1</span> installation</h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">
<pre class="src src-shell">pip install tksheet
</pre>
</div>
</div>
</div>

<div id="outline-container-org9567756" class="outline-3">
<h3 id="org9567756"><span class="section-number-3">8.2</span> source</h3>
<div class="outline-text-3" id="text-8-2">
<p>
<a href="https://github.com/ragardner/tksheet">https://github.com/ragardner/tksheet</a>
</p>
</div>
</div>

<div id="outline-container-orgcc3cc31" class="outline-3">
<h3 id="orgcc3cc31"><span class="section-number-3">8.3</span> paramètres</h3>
<div class="outline-text-3" id="text-8-3">
<p>
<a href="https://github.com/ragardner/tksheet/blob/master/DOCUMENTATION.md">https://github.com/ragardner/tksheet/blob/master/DOCUMENTATION.md</a>
</p>
</div>
</div>

<div id="outline-container-org8a86304" class="outline-3">
<h3 id="org8a86304"><span class="section-number-3">8.4</span> fonctions</h3>
<div class="outline-text-3" id="text-8-4">
<p>
<a href="https://github.com/ragardner/tksheet/blob/master/tksheet/_tksheet.py">https://github.com/ragardner/tksheet/blob/master/tksheet/_tksheet.py</a>
</p>
</div>
</div>
</div>


<div id="outline-container-orgfeea966" class="outline-2">
<h2 id="orgfeea966"><span class="section-number-2">9</span> Fonctionnalités  et Modèle Conceptuel des Données (MCD)</h2>
<div class="outline-text-2" id="text-9">
<p>
Les fonctionnalités attendues sont les suivantes :
</p>
</div>

<div id="outline-container-org488d518" class="outline-3">
<h3 id="org488d518"><span class="section-number-3">9.1</span> Ajout de discipline ;</h3>
<div class="outline-text-3" id="text-9-1">
<p>
Seuls les utilisateurs ayant le statut (= rôle au sens sql) de <b>gestionnaire</b>  sont habilités à ajouter des disciplines.
</p>

<ul class="org-ul">
<li>1 gestionnaire peut ajouter une ou plusieurs disciplines</li>
<li>1 discipline peut être ajoutée par 1 gestionnaire</li>
</ul>


<div class="figure">
<p><img src="MCD displines.png" alt="MCD displines.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgfee3c9a" class="outline-3">
<h3 id="orgfee3c9a"><span class="section-number-3">9.2</span> Ajout d'enseignants ;</h3>
</div>
<div id="outline-container-orgef4aa22" class="outline-3">
<h3 id="orgef4aa22"><span class="section-number-3">9.3</span> Ajout d'élèves ;</h3>
</div>
<div id="outline-container-orga56add4" class="outline-3">
<h3 id="orga56add4"><span class="section-number-3">9.4</span> Créer les classes chaque année pour chaque niveau ;</h3>
</div>
<div id="outline-container-org0f8d6aa" class="outline-3">
<h3 id="org0f8d6aa"><span class="section-number-3">9.5</span> Affecter les notes d'une discipline donnée par un professeur à un élève ;</h3>
</div>
<div id="outline-container-org7bc29f0" class="outline-3">
<h3 id="org7bc29f0"><span class="section-number-3">9.6</span> Calculer les moyennes et autres statistiques liées aux notes.</h3>
<div class="outline-text-3" id="text-9-6">

<div class="figure">
<p><img src="some_filename.png" alt="some_filename.png" />
</p>
</div>






<div class="figure">
<p><img src="foo.png" alt="foo.png" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Auteur: Raoul HATTERER</p>
<p class="date">Created: 2020-08-16 Sun 00:55</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
